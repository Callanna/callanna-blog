{"remainingRequest":"/Users/pro/Documents/WebWork/GitHub/iBlog-master/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/pro/Documents/WebWork/GitHub/iBlog-master/.nuxt/auth/schemes/local.js","dependencies":[{"path":"/Users/pro/Documents/WebWork/GitHub/iBlog-master/.nuxt/auth/schemes/local.js","mtime":1597482623749},{"path":"/Users/pro/Documents/WebWork/GitHub/iBlog-master/node_modules/cache-loader/dist/cjs.js","mtime":1583743859870},{"path":"/Users/pro/Documents/WebWork/GitHub/iBlog-master/node_modules/babel-loader/lib/index.js","mtime":1578715241550}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzNi5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwoKdmFyIExvY2FsU2NoZW1lID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTG9jYWxTY2hlbWUoYXV0aCwgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvY2FsU2NoZW1lKTsKCiAgICB0aGlzLiRhdXRoID0gYXV0aDsKICAgIHRoaXMubmFtZSA9IG9wdGlvbnMuX25hbWU7CiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUUywgb3B0aW9ucyk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTG9jYWxTY2hlbWUsIFt7CiAgICBrZXk6ICJfc2V0VG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRUb2tlbih0b2tlbikgewogICAgICBpZiAodGhpcy5vcHRpb25zLmdsb2JhbFRva2VuKSB7CiAgICAgICAgLy8gU2V0IEF1dGhvcml6YXRpb24gdG9rZW4gZm9yIGFsbCBheGlvcyByZXF1ZXN0cwogICAgICAgIHRoaXMuJGF1dGguY3R4LmFwcC4kYXhpb3Muc2V0SGVhZGVyKHRoaXMub3B0aW9ucy50b2tlbk5hbWUsIHRva2VuKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIl9jbGVhclRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2xlYXJUb2tlbigpIHsKICAgICAgaWYgKHRoaXMub3B0aW9ucy5nbG9iYWxUb2tlbikgewogICAgICAgIC8vIENsZWFyIEF1dGhvcml6YXRpb24gdG9rZW4gZm9yIGFsbCBheGlvcyByZXF1ZXN0cwogICAgICAgIHRoaXMuJGF1dGguY3R4LmFwcC4kYXhpb3Muc2V0SGVhZGVyKHRoaXMub3B0aW9ucy50b2tlbk5hbWUsIGZhbHNlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm1vdW50ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICAgIGlmICh0aGlzLm9wdGlvbnMudG9rZW5SZXF1aXJlZCkgewogICAgICAgIHZhciB0b2tlbiA9IHRoaXMuJGF1dGguc3luY1Rva2VuKHRoaXMubmFtZSk7CgogICAgICAgIHRoaXMuX3NldFRva2VuKHRva2VuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuJGF1dGguZmV0Y2hVc2VyT25jZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImxvZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9naW4gPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVuZHBvaW50KSB7CiAgICAgICAgdmFyIHJlc3VsdCwgdG9rZW47CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmRwb2ludHMubG9naW4pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2dvdXRMb2NhbGx5KCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGF1dGgucmVxdWVzdChlbmRwb2ludCwgdGhpcy5vcHRpb25zLmVuZHBvaW50cy5sb2dpbik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlblJlcXVpcmVkKSB7CiAgICAgICAgICAgICAgICAgIHRva2VuID0gdGhpcy5vcHRpb25zLnRva2VuVHlwZSA/IHRoaXMub3B0aW9ucy50b2tlblR5cGUgKyAnICcgKyByZXN1bHQgOiByZXN1bHQ7CiAgICAgICAgICAgICAgICAgIHRoaXMuJGF1dGguc2V0VG9rZW4odGhpcy5uYW1lLCB0b2tlbik7CgogICAgICAgICAgICAgICAgICB0aGlzLl9zZXRUb2tlbih0b2tlbik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdGhpcy5mZXRjaFVzZXIoKSk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBsb2dpbihfeCkgewogICAgICAgIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvZ2luOwogICAgfSgpCiAgfSwgewogICAga2V5OiAic2V0VXNlclRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc2V0VXNlclRva2VuID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIodG9rZW5WYWx1ZSkgewogICAgICAgIHZhciB0b2tlbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ291dExvY2FsbHkoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlblJlcXVpcmVkKSB7CiAgICAgICAgICAgICAgICAgIHRva2VuID0gdGhpcy5vcHRpb25zLnRva2VuVHlwZSA/IHRoaXMub3B0aW9ucy50b2tlblR5cGUgKyAnICcgKyB0b2tlblZhbHVlIDogdG9rZW5WYWx1ZTsKICAgICAgICAgICAgICAgICAgdGhpcy4kYXV0aC5zZXRUb2tlbih0aGlzLm5hbWUsIHRva2VuKTsKCiAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFRva2VuKHRva2VuKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgdGhpcy5mZXRjaFVzZXIoKSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHNldFVzZXJUb2tlbihfeDIpIHsKICAgICAgICByZXR1cm4gX3NldFVzZXJUb2tlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc2V0VXNlclRva2VuOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZmV0Y2hVc2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZmV0Y2hVc2VyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoZW5kcG9pbnQpIHsKICAgICAgICB2YXIgdXNlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy5vcHRpb25zLnRva2VuUmVxdWlyZWQgJiYgIXRoaXMuJGF1dGguZ2V0VG9rZW4odGhpcy5uYW1lKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5kcG9pbnRzLnVzZXIpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLiRhdXRoLnNldFVzZXIoe30pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kYXV0aC5yZXF1ZXN0V2l0aCh0aGlzLm5hbWUsIGVuZHBvaW50LCB0aGlzLm9wdGlvbnMuZW5kcG9pbnRzLnVzZXIpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICB1c2VyID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICB0aGlzLiRhdXRoLnNldFVzZXIodXNlcik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGZldGNoVXNlcihfeDMpIHsKICAgICAgICByZXR1cm4gX2ZldGNoVXNlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZmV0Y2hVc2VyOwogICAgfSgpCiAgfSwgewogICAga2V5OiAibG9nb3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9nb3V0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoZW5kcG9pbnQpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZW5kcG9pbnRzLmxvZ291dCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRhdXRoLnJlcXVlc3RXaXRoKHRoaXMubmFtZSwgZW5kcG9pbnQsIHRoaXMub3B0aW9ucy5lbmRwb2ludHMubG9nb3V0KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB0aGlzLl9sb2dvdXRMb2NhbGx5KCkpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBsb2dvdXQoX3g0KSB7CiAgICAgICAgcmV0dXJuIF9sb2dvdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvZ291dDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIl9sb2dvdXRMb2NhbGx5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9nb3V0TG9jYWxseTIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlblJlcXVpcmVkKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyVG9rZW4oKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgdGhpcy4kYXV0aC5yZXNldCgpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX2xvZ291dExvY2FsbHkoKSB7CiAgICAgICAgcmV0dXJuIF9sb2dvdXRMb2NhbGx5Mi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX2xvZ291dExvY2FsbHk7CiAgICB9KCkKICB9XSk7CgogIHJldHVybiBMb2NhbFNjaGVtZTsKfSgpOwoKZXhwb3J0IHsgTG9jYWxTY2hlbWUgYXMgZGVmYXVsdCB9Owp2YXIgREVGQVVMVFMgPSB7CiAgdG9rZW5SZXF1aXJlZDogdHJ1ZSwKICB0b2tlblR5cGU6ICdCZWFyZXInLAogIGdsb2JhbFRva2VuOiB0cnVlLAogIHRva2VuTmFtZTogJ0F1dGhvcml6YXRpb24nCn07"},{"version":3,"sources":["/Users/pro/Documents/WebWork/GitHub/iBlog-master/.nuxt/auth/schemes/local.js"],"names":["LocalScheme","auth","options","$auth","name","_name","Object","assign","DEFAULTS","token","globalToken","ctx","app","$axios","setHeader","tokenName","tokenRequired","syncToken","_setToken","fetchUserOnce","endpoint","endpoints","login","_logoutLocally","request","result","tokenType","setToken","fetchUser","tokenValue","getToken","user","setUser","requestWith","logout","catch","_clearToken","reset"],"mappings":";;;;;;IAAqBA,W;;;AACnB,uBAAaC,IAAb,EAAmBC,OAAnB,EAA4B;AAAA;;AAC1B,SAAKC,KAAL,GAAaF,IAAb;AACA,SAAKG,IAAL,GAAYF,OAAO,CAACG,KAApB;AAEA,SAAKH,OAAL,GAAeI,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBC,QAAlB,EAA4BN,OAA5B,CAAf;AACD;;;;8BAEUO,K,EAAO;AAChB,UAAI,KAAKP,OAAL,CAAaQ,WAAjB,EAA8B;AAC5B;AACA,aAAKP,KAAL,CAAWQ,GAAX,CAAeC,GAAf,CAAmBC,MAAnB,CAA0BC,SAA1B,CAAoC,KAAKZ,OAAL,CAAaa,SAAjD,EAA4DN,KAA5D;AACD;AACF;;;kCAEc;AACb,UAAI,KAAKP,OAAL,CAAaQ,WAAjB,EAA8B;AAC5B;AACA,aAAKP,KAAL,CAAWQ,GAAX,CAAeC,GAAf,CAAmBC,MAAnB,CAA0BC,SAA1B,CAAoC,KAAKZ,OAAL,CAAaa,SAAjD,EAA4D,KAA5D;AACD;AACF;;;8BAEU;AACT,UAAI,KAAKb,OAAL,CAAac,aAAjB,EAAgC;AAC9B,YAAMP,KAAK,GAAG,KAAKN,KAAL,CAAWc,SAAX,CAAqB,KAAKb,IAA1B,CAAd;;AACA,aAAKc,SAAL,CAAeT,KAAf;AACD;;AAED,aAAO,KAAKN,KAAL,CAAWgB,aAAX,EAAP;AACD;;;;;;+CAEYC,Q;;;;;;oBACN,KAAKlB,OAAL,CAAamB,SAAb,CAAuBC,K;;;;;;;;;uBAKtB,KAAKC,cAAL,E;;;;uBAEe,KAAKpB,KAAL,CAAWqB,OAAX,CACnBJ,QADmB,EAEnB,KAAKlB,OAAL,CAAamB,SAAb,CAAuBC,KAFJ,C;;;AAAfG,gBAAAA,M;;AAKN,oBAAI,KAAKvB,OAAL,CAAac,aAAjB,EAAgC;AACxBP,kBAAAA,KADwB,GAChB,KAAKP,OAAL,CAAawB,SAAb,GACV,KAAKxB,OAAL,CAAawB,SAAb,GAAyB,GAAzB,GAA+BD,MADrB,GAEVA,MAH0B;AAK9B,uBAAKtB,KAAL,CAAWwB,QAAX,CAAoB,KAAKvB,IAAzB,EAA+BK,KAA/B;;AACA,uBAAKS,SAAL,CAAeT,KAAf;AACD;;iDAEM,KAAKmB,SAAL,E;;;;;;;;;;;;;;;;;;;;;gDAGWC,U;;;;;;;uBAEZ,KAAKN,cAAL,E;;;AAEN,oBAAI,KAAKrB,OAAL,CAAac,aAAjB,EAAgC;AACxBP,kBAAAA,KADwB,GAChB,KAAKP,OAAL,CAAawB,SAAb,GACV,KAAKxB,OAAL,CAAawB,SAAb,GAAyB,GAAzB,GAA+BG,UADrB,GAEVA,UAH0B;AAK9B,uBAAK1B,KAAL,CAAWwB,QAAX,CAAoB,KAAKvB,IAAzB,EAA+BK,KAA/B;;AACA,uBAAKS,SAAL,CAAeT,KAAf;AACD;;kDAEM,KAAKmB,SAAL,E;;;;;;;;;;;;;;;;;;;;;gDAGQR,Q;;;;;;sBAEX,KAAKlB,OAAL,CAAac,aAAb,IAA8B,CAAC,KAAKb,KAAL,CAAW2B,QAAX,CAAoB,KAAK1B,IAAzB,C;;;;;;;;oBAK9B,KAAKF,OAAL,CAAamB,SAAb,CAAuBU,I;;;;;AAC1B,qBAAK5B,KAAL,CAAW6B,OAAX,CAAmB,EAAnB;;;;;uBAKiB,KAAK7B,KAAL,CAAW8B,WAAX,CACjB,KAAK7B,IADY,EAEjBgB,QAFiB,EAGjB,KAAKlB,OAAL,CAAamB,SAAb,CAAuBU,IAHN,C;;;AAAbA,gBAAAA,I;AAKN,qBAAK5B,KAAL,CAAW6B,OAAX,CAAmBD,IAAnB;;;;;;;;;;;;;;;;;;;;;gDAGYX,Q;;;;;qBAER,KAAKlB,OAAL,CAAamB,SAAb,CAAuBa,M;;;;;;uBACnB,KAAK/B,KAAL,CACH8B,WADG,CACS,KAAK7B,IADd,EACoBgB,QADpB,EAC8B,KAAKlB,OAAL,CAAamB,SAAb,CAAuBa,MADrD,EAEHC,KAFG,CAEG,YAAM,CAAG,CAFZ,C;;;kDAMD,KAAKZ,cAAL,E;;;;;;;;;;;;;;;;;;;;;;;;;;AAIP,oBAAI,KAAKrB,OAAL,CAAac,aAAjB,EAAgC;AAC9B,uBAAKoB,WAAL;AACD;;kDAEM,KAAKjC,KAAL,CAAWkC,KAAX,E;;;;;;;;;;;;;;;;;;;;;SA9GUrC,W;AAkHrB,IAAMQ,QAAQ,GAAG;AACfQ,EAAAA,aAAa,EAAE,IADA;AAEfU,EAAAA,SAAS,EAAE,QAFI;AAGfhB,EAAAA,WAAW,EAAE,IAHE;AAIfK,EAAAA,SAAS,EAAE;AAJI,CAAjB","sourcesContent":["export default class LocalScheme {\n  constructor (auth, options) {\n    this.$auth = auth\n    this.name = options._name\n\n    this.options = Object.assign({}, DEFAULTS, options)\n  }\n\n  _setToken (token) {\n    if (this.options.globalToken) {\n      // Set Authorization token for all axios requests\n      this.$auth.ctx.app.$axios.setHeader(this.options.tokenName, token)\n    }\n  }\n\n  _clearToken () {\n    if (this.options.globalToken) {\n      // Clear Authorization token for all axios requests\n      this.$auth.ctx.app.$axios.setHeader(this.options.tokenName, false)\n    }\n  }\n\n  mounted () {\n    if (this.options.tokenRequired) {\n      const token = this.$auth.syncToken(this.name)\n      this._setToken(token)\n    }\n\n    return this.$auth.fetchUserOnce()\n  }\n\n  async login (endpoint) {\n    if (!this.options.endpoints.login) {\n      return\n    }\n\n    // Ditch any leftover local tokens before attempting to log in\n    await this._logoutLocally()\n\n    const result = await this.$auth.request(\n      endpoint,\n      this.options.endpoints.login\n    )\n\n    if (this.options.tokenRequired) {\n      const token = this.options.tokenType\n        ? this.options.tokenType + ' ' + result\n        : result\n\n      this.$auth.setToken(this.name, token)\n      this._setToken(token)\n    }\n\n    return this.fetchUser()\n  }\n\n  async setUserToken (tokenValue) {\n    // Ditch any leftover local tokens before attempting to log in\n    await this._logoutLocally()\n\n    if (this.options.tokenRequired) {\n      const token = this.options.tokenType\n        ? this.options.tokenType + ' ' + tokenValue\n        : tokenValue\n\n      this.$auth.setToken(this.name, token)\n      this._setToken(token)\n    }\n\n    return this.fetchUser()\n  }\n\n  async fetchUser (endpoint) {\n    // Token is required but not available\n    if (this.options.tokenRequired && !this.$auth.getToken(this.name)) {\n      return\n    }\n\n    // User endpoint is disabled.\n    if (!this.options.endpoints.user) {\n      this.$auth.setUser({})\n      return\n    }\n\n    // Try to fetch user and then set\n    const user = await this.$auth.requestWith(\n      this.name,\n      endpoint,\n      this.options.endpoints.user\n    )\n    this.$auth.setUser(user)\n  }\n\n  async logout (endpoint) {\n    // Only connect to logout endpoint if it's configured\n    if (this.options.endpoints.logout) {\n      await this.$auth\n        .requestWith(this.name, endpoint, this.options.endpoints.logout)\n        .catch(() => { })\n    }\n\n    // But logout locally regardless\n    return this._logoutLocally()\n  }\n\n  async _logoutLocally () {\n    if (this.options.tokenRequired) {\n      this._clearToken()\n    }\n\n    return this.$auth.reset()\n  }\n}\n\nconst DEFAULTS = {\n  tokenRequired: true,\n  tokenType: 'Bearer',\n  globalToken: true,\n  tokenName: 'Authorization'\n}\n"]}]}